INFO: localdir at /scratch/936643.yma
INFO: your job will run on local system.
                                         clean_title      id  2_way_label
0  my walgreens offbrand mucinex was engraved wit...  awxhir            1
1                this concerned sink with a tiny hat  98pbid            0
2      hackers leak emails from uae ambassador to us  6f2cy5            1
3                           puppy taking in the view  4xypkv            1
4               i found a face in my sheet music too  8gnet9            0
training set:(564000, 3)
validation set:(59342, 3)
testing set:(59319, 3)
Epoch: 0, batch: 35251/1, avg_loss: 0.46755924820899963, loss_per_50: 0.009351184964179993, time:3.01s
Traceback (most recent call last):
  File "/home/yma/thesis_project/FakeNewsDetection_MSc_thesis/main.py", line 61, in <module>
    main(opt)
  File "/home/yma/thesis_project/FakeNewsDetection_MSc_thesis/main.py", line 56, in main
    epoch_time = experiment.train(epoch)
  File "/home/yma/thesis_project/FakeNewsDetection_MSc_thesis/experiments/clip_exper.py", line 67, in train
    loss = (self.ent_loss(logits_per_image, ground_truth) + self.ent_loss(logits_per_text, ground_truth)) / 2
  File "/home/yma/miniconda3/envs/NLP_project/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/yma/miniconda3/envs/NLP_project/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yma/miniconda3/envs/NLP_project/lib/python3.9/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/home/yma/miniconda3/envs/NLP_project/lib/python3.9/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
ValueError: Expected input batch_size (15) to match target batch_size (16).
